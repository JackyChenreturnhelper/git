# CDN

CDN的全稱是Content Delivery Network，即內容分發網絡。

CDN 的關鍵技術主要有內容存儲和分發技術。

CDN是構建在網絡之上的內容分發網絡，依靠部署在各地的邊緣服務器，通過中心平台的負載均衡、內容分發、調度等功能模塊，使用戶就近獲取所需內容，降低網絡擁塞，提高用戶訪問響應速度和命中率。

CDN代表了一種基於網絡而構建的高質量、高效率、具有鮮明網絡秩序的網絡應用服務模式。

打比方 就類試我在網路上買了一個高鐵票，可是我要大老遠去高鐵站拿票，可是後來有7-11可以拿票，就不用大老遠去高鐵站拿票。

CDN就可以理解為分佈在每個7-11的拿票點，用戶在瀏覽網站的時候，CDN會選擇一個離用戶最近的CDN邊緣節點來響應用戶的請求，這樣移動用戶的請求就不會千里迢迢跑到機房的服務器（假設源站部署在機房）上了。

CDN的優勢很明顯：（1）CDN節點解決了跨運營商和跨地域訪問的問題，訪問延時大大降低；（2）大部分請求在CDN邊緣節點完成，CDN起到了分流作用，減輕了源站的負載。

## CDN工作原理
### 1.未加CDN緩存的網站

    1.用戶在瀏覽器地址欄輸入要訪問的域名

    2.瀏覽器解析域名得到對應的IP地址，再向此IP地址的服務器發出訪問請求

    3.瀏覽器根據服務器返回的東西顯示網頁內容
### 2.加CDN緩存的網站
    1.用戶在瀏覽器中輸入要訪問的域名
    2.瀏覽器對域名解析，（CDN對域名解析過程進行了調整）得到該域名的CNAME記錄，然後利用全局的負載均衡DNS解析得到實際的IP地址
    3.瀏覽器在得到了實際的IP地址（緩存服務器的IP）後向緩存服務器發出訪問請求
    4.緩存服務器根據瀏覽器提供的要訪問的域名通過DNS解析得到該域名對應的實際的IP地址，然後該緩存服務器向此實際IP地址提交訪問請求
    5.緩存服務器從實際IP地址得到內容後，進行兩個操作：
        1.將得到的內容保存到本地，以便以後使用
        2.將獲取的內容返回給客戶端，完成數據服務過程

## CDN關鍵技術
CND關鍵技術有：內容路由技術、內容分發技術、內容存儲技術、內容管理技術

1.內容路由功能

    1.CDN的負載均衡系統實現CDN的內容路由功能。CDN內容路由功能作用使用戶請求到達CDN網絡中的最佳節點

    2.全局負載均衡主要目的是讓用戶的請求到達CDN網絡中最近的節點

    3.局部負載均衡在特定的範圍內尋找一台合適的節點提供服務（要考慮到節點的健康性、負載情況、支持的媒體格式等運行狀態）
2.內容分發技術

內容分發技術主要是PUSH和PULL

    1.PUSH是一種主動分發的技術，通常由內容管理系統發起，將內容從源或者中心媒體資源庫發佈到各個邊緣的Cache節點（HTTP/FTP）

    2.PULL 是一種被動的分發技術，當用戶請求的內容不在請求所達到的邊緣Cache的節點上時，該節點會從內容源或其他節點PULL下所需的內容（按需分發）
3.內容存儲技術

    1.內容源的存儲
    通常採用海量存儲架構（內容的規模及吞吐量較大）
    2.在Cache節點中的存儲
    Cache節點的存儲要考慮：
        1.功能上，對各種內容格式的支持、對部分緩存的支持
        2.性能上，容量大小，吞吐率、可靠性及穩定性
4.內容管理技術

本地內容管理（對Cache節點而言）的目標是提高內容服務的效率，提高本地節點的存儲利用率。

    1.本地內容索引是實現基於內容感知調度的關鍵

    2.本地內容的複制。通常為了提高存儲的效率，同一個內容只在某個特定的節點中存儲一份，當對該內容的訪問超過這個節點的能力範圍，就將該內容進行分發到其他節點上

    3.本地內容訪問狀態的收集。蒐集各個節點上各個內容訪問的統計信息，節點可用服務能力及內容變化的情況